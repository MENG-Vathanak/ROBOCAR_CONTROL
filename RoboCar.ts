//% color="#FFA500" weight=20 icon="data:image/png;base64,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"
namespace RoboCar {
    const PCA9685_ADD = 0x40
    const MODE1 = 0x00
    const MODE2 = 0x01
    const SUBADR1 = 0x02
    const SUBADR2 = 0x03
    const SUBADR3 = 0x04
    const LED0_ON_L = 0x06
    const LED0_ON_H = 0x07
    const LED0_OFF_L = 0x08
    const LED0_OFF_H = 0x09

    const ALL_LED_ON_L = 0xFA
    const ALL_LED_ON_H = 0xFB
    const ALL_LED_OFF_L = 0xFC
    const ALL_LED_OFF_H = 0xFD

    const PRESCALE = 0xFE
    let initialized = false
    let yahStrip: neopixel.Strip;

    export enum enMusic {
        dadadum = 0,
        entertainer,
        prelude,
        ode,
        nyan,
        ringtone,
        funk,
        blues,
        birthday,
        wedding,
        funereal,
        punchline,
        baddy,
        chase,
        ba_ding,
        wawawawaa,
        jump_up,
        jump_down,
        power_up,
        power_down
    }
    export enum enServo {
        S1 = 2,
        S2 = 3,
        S3 = 4,
        S4 = 5,
    }
    export enum enMotors {
        M1 = 8,
        M2 = 1,
        M3 = 9,
        M4 = 0
    }
    export enum enMovement {
        forward = 0,
        backward = 1,
        leftSide = 2,
        rightSide = 3,
        rotateRight = 4,
        rotateLeft = 5,
        forwardLeft = 6,
        forwardRight = 7,
        backwardLeft = 8,
        backwardRight = 9
    }
    function i2cwrite(addr: number, reg: number, value: number) {
        let buf = pins.createBuffer(2)
        buf[0] = reg
        buf[1] = value
        pins.i2cWriteBuffer(addr, buf)
    }
    function i2ccmd(addr: number, value: number) {
        let buf = pins.createBuffer(1)
        buf[0] = value
        pins.i2cWriteBuffer(addr, buf)
    }
    function i2cread(addr: number, reg: number) {
        pins.i2cWriteNumber(addr, reg, NumberFormat.UInt8BE);
        let val = pins.i2cReadNumber(addr, NumberFormat.UInt8BE);
        return val;
    }
    function initPCA9685(): void {
        i2cwrite(PCA9685_ADD, MODE1, 0x00)
        setFreq(50);
        initialized = true
    }
    function setFreq(freq: number): void {
        // Constrain the frequency
        let prescaleval = 25000000;
        prescaleval /= 4096;
        prescaleval /= freq;
        prescaleval -= 1;
        let prescale = prescaleval; //Math.Floor(prescaleval + 0.5);
        let oldmode = i2cread(PCA9685_ADD, MODE1);
        let newmode = (oldmode & 0x7F) | 0x10; // sleep
        i2cwrite(PCA9685_ADD, MODE1, newmode); // go to sleep
        i2cwrite(PCA9685_ADD, PRESCALE, prescale); // set the prescaler
        i2cwrite(PCA9685_ADD, MODE1, oldmode);
        control.waitMicros(5000);
        i2cwrite(PCA9685_ADD, MODE1, oldmode | 0xa1);
    }
    function setPwm(channel: number, on: number, off: number): void {
        if (channel < 0 || channel > 15)
            return;
        if (!initialized) {
            initPCA9685();
            setFreq(1000);
        }
        let buf = pins.createBuffer(5);
        buf[0] = LED0_ON_L + 4 * channel;
        buf[1] = on & 0xff;
        buf[2] = (on >> 8) & 0xff;
        buf[3] = off & 0xff;
        buf[4] = (off >> 8) & 0xff;
        pins.i2cWriteBuffer(PCA9685_ADD, buf);
    }
    function stopMotor(index: enMotors) {
        setPwm(index, 0, 0);
    }
    function forward(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 0)
        pins.digitalWritePin(DigitalPin.P10, 1)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 1)
        pins.digitalWritePin(DigitalPin.P16, 0)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 0)
        pins.digitalWritePin(DigitalPin.P12, 1)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 1)
        pins.digitalWritePin(DigitalPin.P14, 0)
    }
    function backward(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 1)
        pins.digitalWritePin(DigitalPin.P10, 0)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 0)
        pins.digitalWritePin(DigitalPin.P16, 1)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 1)
        pins.digitalWritePin(DigitalPin.P12, 0)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 0)
        pins.digitalWritePin(DigitalPin.P14, 1)
    }
    function rightSide(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 0)
        pins.digitalWritePin(DigitalPin.P10, 1)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 0)
        pins.digitalWritePin(DigitalPin.P16, 1)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 1)
        pins.digitalWritePin(DigitalPin.P12, 0)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 1)
        pins.digitalWritePin(DigitalPin.P14, 0)
    }
    function leftSide(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 1)
        pins.digitalWritePin(DigitalPin.P10, 0)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 1)
        pins.digitalWritePin(DigitalPin.P16, 0)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 0)
        pins.digitalWritePin(DigitalPin.P12, 1)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 0)
        pins.digitalWritePin(DigitalPin.P14, 1)
    }
    function rotateRight(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 0)
        pins.digitalWritePin(DigitalPin.P10, 1)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 0)
        pins.digitalWritePin(DigitalPin.P16, 1)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 0)
        pins.digitalWritePin(DigitalPin.P12, 1)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 0)
        pins.digitalWritePin(DigitalPin.P14, 1)
    }
    function rotateLeft(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 1)
        pins.digitalWritePin(DigitalPin.P10, 0)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 1)
        pins.digitalWritePin(DigitalPin.P16, 0)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 1)
        pins.digitalWritePin(DigitalPin.P12, 0)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 1)
        pins.digitalWritePin(DigitalPin.P14, 0)
    }
    function forwardLeft(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, 0)
        pins.digitalWritePin(DigitalPin.P9, 0)
        pins.digitalWritePin(DigitalPin.P10, 1)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 1)
        pins.digitalWritePin(DigitalPin.P16, 0)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 0)
        pins.digitalWritePin(DigitalPin.P12, 1)

        setPwm(enMotors.M4, 0, 0)
        pins.digitalWritePin(DigitalPin.P13, 1)
        pins.digitalWritePin(DigitalPin.P14, 0)
    }
    function forwardRight(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 0)
        pins.digitalWritePin(DigitalPin.P10, 1)

        setPwm(enMotors.M2, 0, 0)
        pins.digitalWritePin(DigitalPin.P15, 0)
        pins.digitalWritePin(DigitalPin.P16, 0)

        setPwm(enMotors.M3, 0, 0)
        pins.digitalWritePin(DigitalPin.P11, 0)
        pins.digitalWritePin(DigitalPin.P12, 0)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 1)
        pins.digitalWritePin(DigitalPin.P14, 0)
    }
    function backwardLeft(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P9, 1)
        pins.digitalWritePin(DigitalPin.P10, 0)

        setPwm(enMotors.M2, 0, 0)
        pins.digitalWritePin(DigitalPin.P15, 0)
        pins.digitalWritePin(DigitalPin.P16, 0)

        setPwm(enMotors.M3, 0, 0)
        pins.digitalWritePin(DigitalPin.P11, 0)
        pins.digitalWritePin(DigitalPin.P12, 0)

        setPwm(enMotors.M4, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P13, 0)
        pins.digitalWritePin(DigitalPin.P14, 1)
    }
    function backwardRight(RoboCarSpeed: number) {
        setPwm(enMotors.M1, 0, 0)
        pins.digitalWritePin(DigitalPin.P9, 0)
        pins.digitalWritePin(DigitalPin.P10, 0)

        setPwm(enMotors.M2, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P15, 0)
        pins.digitalWritePin(DigitalPin.P16, 1)

        setPwm(enMotors.M3, 0, RoboCarSpeed)
        pins.digitalWritePin(DigitalPin.P11, 1)
        pins.digitalWritePin(DigitalPin.P12, 0)

        setPwm(enMotors.M4, 0, 0)
        pins.digitalWritePin(DigitalPin.P13, 0)
        pins.digitalWritePin(DigitalPin.P14, 0)
    }
    /**
    * *****************************************************************
     * @param index
     */
    //% blockId=RoboCar_RGB_Program block="RGB_Program"
    //% weight=99
    //% blockGap=10
    //% name.fieldEditor="gridpicker" name.fieldOptions.columns=4
    export function RGB_Program(): neopixel.Strip {
        if (!yahStrip) {
            yahStrip = neopixel.create(DigitalPin.P2, 4, NeoPixelMode.RGB);
        }
        return yahStrip;
    }
    //% blockId=SuperBit_Music block="Music|%index"
    //% weight=98
    //% blockGap=10
    //% name.fieldEditor="gridpicker" name.fieldOptions.columns=4
    export function Music(index: enMusic): void {
        switch (index) {
            case enMusic.dadadum: music.beginMelody(music.builtInMelody(Melodies.Dadadadum), MelodyOptions.Once); break;
            case enMusic.birthday: music.beginMelody(music.builtInMelody(Melodies.Birthday), MelodyOptions.Once); break;
            case enMusic.entertainer: music.beginMelody(music.builtInMelody(Melodies.Entertainer), MelodyOptions.Once); break;
            case enMusic.prelude: music.beginMelody(music.builtInMelody(Melodies.Prelude), MelodyOptions.Once); break;
            case enMusic.ode: music.beginMelody(music.builtInMelody(Melodies.Ode), MelodyOptions.Once); break;
            case enMusic.nyan: music.beginMelody(music.builtInMelody(Melodies.Nyan), MelodyOptions.Once); break;
            case enMusic.ringtone: music.beginMelody(music.builtInMelody(Melodies.Ringtone), MelodyOptions.Once); break;
            case enMusic.funk: music.beginMelody(music.builtInMelody(Melodies.Funk), MelodyOptions.Once); break;
            case enMusic.blues: music.beginMelody(music.builtInMelody(Melodies.Blues), MelodyOptions.Once); break;
            case enMusic.wedding: music.beginMelody(music.builtInMelody(Melodies.Wedding), MelodyOptions.Once); break;
            case enMusic.funereal: music.beginMelody(music.builtInMelody(Melodies.Funeral), MelodyOptions.Once); break;
            case enMusic.punchline: music.beginMelody(music.builtInMelody(Melodies.Punchline), MelodyOptions.Once); break;
            case enMusic.baddy: music.beginMelody(music.builtInMelody(Melodies.Baddy), MelodyOptions.Once); break;
            case enMusic.chase: music.beginMelody(music.builtInMelody(Melodies.Chase), MelodyOptions.Once); break;
            case enMusic.ba_ding: music.beginMelody(music.builtInMelody(Melodies.BaDing), MelodyOptions.Once); break;
            case enMusic.wawawawaa: music.beginMelody(music.builtInMelody(Melodies.Wawawawaa), MelodyOptions.Once); break;
            case enMusic.jump_up: music.beginMelody(music.builtInMelody(Melodies.JumpUp), MelodyOptions.Once); break;
            case enMusic.jump_down: music.beginMelody(music.builtInMelody(Melodies.JumpDown), MelodyOptions.Once); break;
            case enMusic.power_up: music.beginMelody(music.builtInMelody(Melodies.PowerUp), MelodyOptions.Once); break;
            case enMusic.power_down: music.beginMelody(music.builtInMelody(Melodies.PowerDown), MelodyOptions.Once); break;
        }
    }
    //% blockId=RoboCar_Servo block="SERVO(180°)|%num|degree %value"
    //% weight=97
    //% blockGap=10
    //% num.min=1 num.max=4 value.min=0 value.max=180
    //% name.fieldEditor="gridpicker" name.fieldOptions.columns=20
    export function Servo(num: enServo, value: number): void {
        if (!initialized) {
            initPCA9685();
        }
        // 50hz: 20,000 us
        let us = (value * 1800 / 180 + 600); // 0.6 ~ 2.4
        let pwm = us * 4096 / 20000;
        setPwm(num, 0, pwm);
    }
    //% blockId=RoboCar_Servo2 block="SERVO(270°)|%num|degree %value"
    //% weight=96
    //% blockGap=10
    //% num.min=1 num.max=4 value.min=0 value.max=270
    //% name.fieldEditor="gridpicker" name.fieldOptions.columns=20
    export function Servo2(num: enServo, value: number): void {
        if (!initialized) {
            initPCA9685();
        }
        // 50hz: 20,000 us
        let newvalue = Math.map(value, 0, 270, 0, 180);
        let us = (newvalue * 1800 / 180 + 600); // 0.6 ~ 2.4
        let pwm = us * 4096 / 20000;
        setPwm(num, 0, pwm);
    }
    //% blockId=RoboCar_MotorRun block="Motor|%index|speed %speed"
    //% weight=93
    //% speed.min=-255 speed.max=255
    //% name.fieldEditor="gridpicker" name.fieldOptions.columns=4
    export function MotorRun(index: enMotors, speed: number): void {

        led.enable(false)
        speed = (speed * 16) * 0.85; // (map 255 to 4096)
        if (speed >= 4096 * 0.85) {
            speed = 4096 * 0.85
        }
        if (speed <= -(4096 * 0.85)) {
            speed = -(4096 * 0.85)
        }
        if (index == 0) {
            if (speed > 0) {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P13, 1)
                pins.digitalWritePin(DigitalPin.P14, 0)
            } else if (speed < 0) {
                setPwm(index, 0, -speed)
                pins.digitalWritePin(DigitalPin.P13, 0)
                pins.digitalWritePin(DigitalPin.P14, 1)
            } else {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P13, 0)
                pins.digitalWritePin(DigitalPin.P14, 0)
            }
        }
        if (index == 1) {
            if (speed > 0) {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P15, 1)
                pins.digitalWritePin(DigitalPin.P16, 0)
            } else if (speed < 0) {
                setPwm(index, 0, -speed)
                pins.digitalWritePin(DigitalPin.P15, 0)
                pins.digitalWritePin(DigitalPin.P16, 1)
            } else {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P15, 0)
                pins.digitalWritePin(DigitalPin.P16, 0)
            }
        }
        if (index == 8) {
            if (speed > 0) {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P9, 0)
                pins.digitalWritePin(DigitalPin.P10, 1)
            } else if (speed < 0) {
                setPwm(index, 0, -speed)
                pins.digitalWritePin(DigitalPin.P9, 1)
                pins.digitalWritePin(DigitalPin.P10, 0)
            } else {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P9, 0)
                pins.digitalWritePin(DigitalPin.P10, 0)
            }
        }
        if (index == 9) {
            if (speed > 0) {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P11, 0)
                pins.digitalWritePin(DigitalPin.P12, 1)
            } else if (speed < 0) {
                setPwm(index, 0, -speed)
                pins.digitalWritePin(DigitalPin.P11, 1)
                pins.digitalWritePin(DigitalPin.P12, 0)
            } else {
                setPwm(index, 0, speed)
                pins.digitalWritePin(DigitalPin.P11, 0)
                pins.digitalWritePin(DigitalPin.P12, 0)
            }
        }
    }
    //% blockId=RoboCar_MotorStopAll block="Motor Stop All"
    //% weight=91
    //% blockGap=50
    export function MotorStopAll(): void {

        stopMotor(enMotors.M1);
        stopMotor(enMotors.M2);
        stopMotor(enMotors.M3);
        stopMotor(enMotors.M4);

    }
    //% blockId=RoboCar_Movement block="RoboCar|%index|speed %speed"
    //% weight=93
    //% speed.min=0 speed.max=255
    // % name.fieldEditor="gridpicker" name.fieldOptions.columns=4
    export function RoboCar_Movement(index: enMovement, speed: number): void {

        led.enable(false)

        speed = (speed * 16) * 0.85; // map 255 to 4096
        if (speed >= 4096 * 0.85) {
            speed = 4096 * 0.85
        }
        if (index == 0) {
            forward(speed)
        } else if (index == 1) {
            backward(speed)
        } else if (index == 2) {
            leftSide(speed)
        } else if (index == 3) {
            rightSide(speed)
        } else if (index == 4) {
            rotateRight(speed)
        } else if (index == 5) {
            rotateLeft(speed)
        } else if (index == 6) {
            forwardLeft(speed)
        } else if (index == 7) {
            forwardRight(speed)
        } else if (index == 8) {
            backwardLeft(speed)
        } else if (index == 9) {
            backwardRight(speed)
        }

    }
    //% blockId=RoboCar_AllMotorRun block="AllMotor|Motor1 speed %speed1|Motor2 speed %speed2|Motor3 speed %speed3|Motor4 speed %speed4"
    //% weight=92
    //% blockGap=50
    //% speed1.min=-255 speed1.max=255
    //% speed2.min=-255 speed2.max=255
    //% speed3.min=-255 speed3.max=255
    //% speed4.min=-255 speed4.max=255
    //% name.fieldEditor="gridpicker" name.fieldOptions.columns=4
    export function AllMotorRun(speed1: number, speed2: number, speed3: number, speed4: number): void {
        MotorRun(enMotors.M1, speed1);
        MotorRun(enMotors.M2, speed2);
        MotorRun(enMotors.M3, speed3);
        MotorRun(enMotors.M4, speed4);
    }
}
